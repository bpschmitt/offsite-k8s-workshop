{
    "componentChunkName": "component---node-modules-rocketseat-gatsby-theme-docs-core-src-templates-docs-query-js",
    "path": "/exercises/03_troubleshooting",
    "result": {"data":{"mdx":{"id":"097e9178-c3ca-5346-9aad-41b51be77b78","excerpt":"03. Troubleshooting In this module you'll learn about some of the more common troubleshooting commands used when troubleshooting issues with a Kubernetesâ€¦","fields":{"slug":"/exercises/03_troubleshooting/"},"frontmatter":{"title":"","description":null,"image":null,"disableTableOfContents":null},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"03-troubleshooting\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#03-troubleshooting\",\n    \"aria-label\": \"03 troubleshooting permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"03. Troubleshooting\"), mdx(\"p\", null, \"In this module you'll learn about some of the more common troubleshooting commands used when troubleshooting issues with a Kubernetes deployment.  Those commands are:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"kubectl describe pod\"), \" (or other resources like \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"node\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"deployment\"), \", etc)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"kubectl logs pod\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"kubectl get events\"))), mdx(\"h3\", {\n    \"id\": \"describing-resources\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#describing-resources\",\n    \"aria-label\": \"describing resources permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Describing Resources\"), mdx(\"p\", null, \"Describing a Kubernetes resource (in this case, a pod) will output its current configuration as well as any related Kubernetes events.  This can be extremely useful in identifying why a pod might not be starting properly.\"), mdx(\"p\", null, \"There are a few things of note here:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The container state and reason (\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"State: Waiting\"), \" - \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Reason: CreateContainerConfigError\"), \")\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The conditions: \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Ready: False\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"ContainersReady: False\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The pod events, specifically \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Error: secret \\\"nrlicensekey\\\" not found\"))), mdx(\"p\", null, \"You've found the culprit.  A required secret is missing so the pod is unable to start successfully.  This happens to be the secret that contains your New Relic license key.  In the next step, you'll create it to resolve the issue.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"[~]$ kubectl describe pod logs-demo-f764d7569-cvh89 -n demo\\nName:         logs-demo-f764d7569-cvh89\\nNamespace:    demo\\nPriority:     0\\nNode:         minikube-lab/192.168.64.12\\nStart Time:   Mon, 08 Nov 2021 17:17:17 -0600\\nLabels:       app=logs-demo\\n              pod-template-hash=f764d7569\\nAnnotations:  <none>\\nStatus:       Pending\\nIP:           10.244.0.94\\nIPs:\\n  IP:           10.244.0.94\\nControlled By:  ReplicaSet/logs-demo-f764d7569\\nContainers:\\n  nodejs-logs-k8s:\\n    Container ID:\\n    Image:          bpschmitt/nodejs-logs-k8s:0.5\\n    Image ID:\\n    Port:           4000/TCP\\n    Host Port:      0/TCP\\n    State:          Waiting\\n      Reason:       CreateContainerConfigError\\n    Ready:          False\\n    Restart Count:  0\\n    Limits:\\n      cpu:     250m\\n      memory:  256M\\n    Requests:\\n      cpu:     250m\\n      memory:  256M\\n    Environment:\\n      NEW_RELIC_LICENSE_KEY:                               <set to the key 'nrlicensekey' in secret 'nrlicensekey'>  Optional: false\\n      NEW_RELIC_APP_NAME:                                  myDemoApp\\n      APP_TITLE:                                           myDemoApp\\n      NEW_RELIC_METADATA_KUBERNETES_CLUSTER_NAME:          minikube-lab\\n      NEW_RELIC_METADATA_KUBERNETES_NODE_NAME:              (v1:spec.nodeName)\\n      NEW_RELIC_METADATA_KUBERNETES_NAMESPACE_NAME:        demo (v1:metadata.namespace)\\n      NEW_RELIC_METADATA_KUBERNETES_POD_NAME:              logs-demo-f764d7569-cvh89 (v1:metadata.name)\\n      NEW_RELIC_METADATA_KUBERNETES_CONTAINER_NAME:        nodejs-logs-k8s\\n      NEW_RELIC_METADATA_KUBERNETES_CONTAINER_IMAGE_NAME:  bpschmitt/nodejs-logs-k8s:0.5\\n      NEW_RELIC_METADATA_KUBERNETES_DEPLOYMENT_NAME:       logs-demo\\n    Mounts:\\n      /var/run/secrets/kubernetes.io/serviceaccount from default-token-75ldr (ro)\\nConditions:\\n  Type              Status\\n  Initialized       True\\n  Ready             False\\n  ContainersReady   False\\n  PodScheduled      True\\nVolumes:\\n  default-token-75ldr:\\n    Type:        Secret (a volume populated by a Secret)\\n    SecretName:  default-token-75ldr\\n    Optional:    false\\nQoS Class:       Guaranteed\\nNode-Selectors:  <none>\\nTolerations:     node.kubernetes.io/not-ready:NoExecute op=Exists for 300s\\n                 node.kubernetes.io/unreachable:NoExecute op=Exists for 300s\\nEvents:\\n  Type     Reason     Age                  From               Message\\n  ----     ------     ----                 ----               -------\\n  Normal   Scheduled  51m                  default-scheduler  Successfully assigned demo/logs-demo-f764d7569-cvh89 to minikube-lab\\n  Warning  Failed     30m (x94 over 51m)   kubelet            Error: secret \\\"nrlicensekey\\\" not found\\n  Normal   Pulled     68s (x231 over 51m)  kubelet            Container image \\\"bpschmitt/nodejs-logs-k8s:0.5\\\" already present on machine\\n\")), mdx(\"p\", null, \"To fix this issue, create a secret called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"nrlicensekey\"), \" which contains your New Relic license key with the following command:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"kubectl create secret generic nrlicensekey --from-literal=nrlicensekey=<NR LICENSE KEY> -n demo\\n\")), mdx(\"h3\", {\n    \"id\": \"events\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#events\",\n    \"aria-label\": \"events permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Events\"), mdx(\"p\", null, \"Sometimes the root cause of a cranky deployment may not be completely obvious from the pod events and you'll need to take a broader look at the cluster events.  You can do this with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kubectl get event\"), \" command.  Note that the example below is scoped to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"demo\"), \" namespace.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"[~]$ kubectl get events -n demo\\nLAST SEEN   TYPE      REASON              OBJECT                                          MESSAGE\\n...\\n4m36s       Normal    Pulled              pod/logs-demo-f764d7569-cvh89                   Container image \\\"bpschmitt/nodejs-logs-k8s:0.5\\\" already present on machine\\n39m         Warning   Failed              pod/logs-demo-f764d7569-cvh89                   Error: secret \\\"nrlicensekey\\\" not found\\n59m         Normal    SuccessfulCreate    replicaset/logs-demo-f764d7569                  Created pod: logs-demo-f764d7569-cvh89\\n59m         Normal    ScalingReplicaSet   deployment/logs-demo                            Scaled up replica set logs-demo-f764d7569 to 1\\n59m         Normal    Scheduled           pod/nginx-557dcdb56b-v4d4c                      Successfully assigned demo/nginx-557dcdb56b-v4d4c to minikube-lab\\n59m         Normal    Pulling             pod/nginx-557dcdb56b-v4d4c                      Pulling image \\\"nginx\\\"\\n59m         Normal    Pulled              pod/nginx-557dcdb56b-v4d4c                      Successfully pulled image \\\"nginx\\\" in 1.079547333s\\n59m         Normal    Created             pod/nginx-557dcdb56b-v4d4c                      Created container nginx\\n59m         Normal    Started             pod/nginx-557dcdb56b-v4d4c                      Started container nginx\\n59m         Normal    SuccessfulCreate    replicaset/nginx-557dcdb56b                     Created pod: nginx-557dcdb56b-v4d4c\\n59m         Normal    ScalingReplicaSet   deployment/nginx                                Scaled up replica set nginx-557dcdb56b to 1\\n...\\n\")), mdx(\"h3\", {\n    \"id\": \"logs\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#logs\",\n    \"aria-label\": \"logs permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Logs\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kubectl logs\"), \" command will show you the container logs for applications running in your pods.  Typically, this is also a great source of information when trying to troubleshoot a problem.  In this example, you'll look at the logs for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"crasher-*\"), \" pod and it will be very obvious what's wrong.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"$ kubectl logs crasher-6f4bccdddd-7hnp8 -n demo\\nTraceback (most recent call last):\\n  File \\\"./app.py\\\", line 9, in <module>\\n    with open('Data.txt') as f:\\nFileNotFoundError: [Errno 2] No such file or directory: 'Data.txt'\\n\")), mdx(\"p\", null, \"If you describe that pod, take a closer look at the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Containers\"), \" section for more detail as to what's happening.  You'll see the container exit code is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"1\"), \" because of the error above.  The container is not able to successfully start and the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"restartPolicy\"), \" for the container is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Always\"), \".  This means that Kubernetes will try to restart the container if it fails, which is why the restart count continues to go up.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"$ kubectl describe pod crasher-6f4bccdddd-7hnp8 -n demo\\n... Truncated ...\\n\\nContainers:\\n  crasher:\\n    Container ID:   docker://49a799e1cd9709974ed621799289bb7de95ea128100ad7d246b48b12378a3450\\n    Image:          mlda065/crasher\\n    Image ID:       docker-pullable://mlda065/crasher@sha256:3f41331adf0362ab245866a8f1a346d867c934b63b2733c0c714b3d4183a490d\\n    Port:           <none>\\n    Host Port:      <none>\\n    State:          Waiting\\n      Reason:       CrashLoopBackOff\\n    Last State:     Terminated\\n      Reason:       Error\\n      Exit Code:    1\\n      Started:      Mon, 08 Nov 2021 21:49:11 -0600\\n      Finished:     Mon, 08 Nov 2021 21:49:11 -0600\\n    Ready:          False\\n    Restart Count:  58\\n\\n  ... Truncated ...\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","headings":[{"depth":2,"value":"03. Troubleshooting"},{"depth":3,"value":"Describing Resources"},{"depth":3,"value":"Events"},{"depth":3,"value":"Logs"}]}},"pageContext":{"slug":"/exercises/03_troubleshooting/","prev":{"label":"Deploy Apps","link":"/exercises/02_deploy_apps"},"next":{"label":"Helm","link":"/exercises/04_helm"},"repositoryEditUrl":"https://github.com/jpedroschmitz/rocketdocs/tree/main/examples/gatsby-theme-docs/src/docs/exercises/03_troubleshooting.mdx","repositoryProvider":"GitHub"}},
    "staticQueryHashes": ["1954253342","2328931024","2501019404","973074209"]}